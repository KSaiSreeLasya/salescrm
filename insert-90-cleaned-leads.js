const SUPABASE_URL = process.env.SUPABASE_URL;
const SUPABASE_KEY = process.env.SUPABASE_SERVICE_ROLE_KEY;

if (!SUPABASE_URL || !SUPABASE_KEY) {
  console.error('Missing SUPABASE_URL or SUPABASE_SERVICE_ROLE_KEY');
  process.exit(1);
}

const cleanedLeads = [
  { "id": "a2c79cc0-a372-42c0-9f9e-1b0dce77993c", "name": "Satish", "email": "satish.143@yahoo.com", "phone": "919966776123", "status": "new", "fields": { "full name": "Satish", "phone": "919966776123", "email": "satish.143@yahoo.com", "post_code": "500017", "lead_status": "COMMON AREA", "street address": "tarnaka", "what_is_your_average_monthly_electricity_bill?": "25000", "what_type_of_property_do_you_want_to_install_solar_on?": "apartment_/_housing_society" } },
  { "id": "68378fac-4949-47e3-bbde-34e4328cffd5", "name": "Bharadwaj", "email": "vssbkingdom@gmail.com", "phone": "917386061616", "status": "new", "fields": { "full name": "Bharadwaj", "phone": "917386061616", "email": "vssbkingdom@gmail.com", "post_code": "500013", "lead_status": "he will call", "street address": "Habsiguda", "what_is_your_average_monthly_electricity_bill?": "6000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "f8b5d855-aed9-49f6-9e47-4f6a353a00e8", "name": "Rahul Rawat", "email": "pilot.rahul@gmail.com", "phone": "919685568444", "status": "new", "fields": { "full name": "Rahul Rawat", "phone": "919685568444", "email": "pilot.rahul@gmail.com", "post_code": "500049", "lead_status": "call", "street address": "kondapur", "what_is_your_average_monthly_electricity_bill?": "8000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "c7e0c9c5-fcaa-4e60-9c31-8c85c73ba0db", "name": "Harishkashi", "email": "kashirajuharish@gmail.com", "phone": "919441833377", "status": "new", "fields": { "full name": "Harishkashi", "phone": "919441833377", "email": "kashirajuharish@gmail.com", "post_code": "500017", "lead_status": "he will call", "street address": "tarnaka", "what_is_your_average_monthly_electricity_bill?": "4000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "8da59f94-5e48-487a-b868-f5d0c8a0a19b", "name": "Singa Raveni", "email": "singaraveni135@gmail.com", "phone": "919346301819", "status": "new", "fields": { "full name": "Singa Raveni", "phone": "919346301819", "email": "singaraveni135@gmail.com", "post_code": "500081", "lead_status": "he will call", "street address": "Mehdipatnam", "what_is_your_average_monthly_electricity_bill?": "7000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "ba914e94-9b99-46de-8c74-6c8c4bdc20c9", "name": "Jabbar Mohammed", "email": "jabbarmohammd1995@gmail.com", "phone": "919494828000", "status": "new", "fields": { "full name": "Jabbar Mohammed", "phone": "919494828000", "email": "jabbarmohammd1995@gmail.com", "post_code": "500016", "lead_status": "he will call", "street address": "Madhapur", "what_is_your_average_monthly_electricity_bill?": "5000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "3a8a14b4-2f15-4b36-8f33-9e4c8c7e2d5b", "name": "Laxman A", "email": "laxman.laxman.a167@gmail.com", "phone": "918500043938", "status": "new", "fields": { "full name": "Laxman A", "phone": "918500043938", "email": "laxman.laxman.a167@gmail.com", "post_code": "500086", "lead_status": "not lifted", "street address": "Banjara Hills", "what_is_your_average_monthly_electricity_bill?": "3500", "what_type_of_property_do_you_want_to_install_solar_on?": "apartment_/_housing_society" } },
  { "id": "7c5d4e6a-9b2f-4f1d-8c3a-5e2b1d4c3a9f", "name": "Purush SMV", "email": "smv_purush@yahoo.co.in", "phone": "919704629293", "status": "new", "fields": { "full name": "Purush SMV", "phone": "919704629293", "email": "smv_purush@yahoo.co.in", "post_code": "500064", "lead_status": "he will call", "street address": "Gachibowli", "what_is_your_average_monthly_electricity_bill?": "8500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "4a3b2c1d-9e8f-4a5b-6c7d-8e9f0a1b2c3d", "name": "Santosh Kumar", "email": "kuthadisantoshkumar8026@gmail.com", "phone": "918886637890", "status": "new", "fields": { "full name": "Santosh Kumar", "phone": "918886637890", "email": "kuthadisantoshkumar8026@gmail.com", "post_code": "500038", "lead_status": "he will call", "street address": "Kukatpalli", "what_is_your_average_monthly_electricity_bill?": "6500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "5f6e7d8c-9b0a-1f2e-3d4c-5b6a7f8e9d0a", "name": "Dileep Kumar", "email": "anem.dileepkumar305@gmail.com", "phone": "919100202525", "status": "new", "fields": { "full name": "Dileep Kumar", "phone": "919100202525", "email": "anem.dileepkumar305@gmail.com", "post_code": "500072", "lead_status": "call", "street address": "Hitech City", "what_is_your_average_monthly_electricity_bill?": "7500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "6a7b8c9d-0e1f-2a3b-4c5d-6e7f8a9b0c1d", "name": "Sasi Kumar", "email": "sasi10137@gmail.com", "phone": "916309688977", "status": "new", "fields": { "full name": "Sasi Kumar", "phone": "916309688977", "email": "sasi10137@gmail.com", "post_code": "500090", "lead_status": "not lifted", "street address": "Jubilee Hills", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "apartment_/_housing_society" } },
  { "id": "7c8d9e0f-1a2b-3c4d-5e6f-7a8b9c0d1e2f", "name": "Jai Pal Yadav", "email": "yadaugjaipal@gmail.com", "phone": "919700567890", "status": "new", "fields": { "full name": "Jai Pal Yadav", "phone": "919700567890", "email": "yadaugjaipal@gmail.com", "post_code": "500082", "lead_status": "he will call", "street address": "Somajiguda", "what_is_your_average_monthly_electricity_bill?": "4500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a", "name": "Dhanvin G", "email": "dhanvin.g@gmail.com", "phone": "919949949894", "status": "new", "fields": { "full name": "Dhanvin G", "phone": "919949949894", "email": "dhanvin.g@gmail.com", "post_code": "500033", "lead_status": "call", "street address": "Ameerpet", "what_is_your_average_monthly_electricity_bill?": "6000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "9e0f1a2b-3c4d-5e6f-7a8b-9c0d1e2f3a4b", "name": "Ashutosh", "email": "ashusavi.daddy@gmail.com", "phone": "919133333333", "status": "new", "fields": { "full name": "Ashutosh", "phone": "919133333333", "email": "ashusavi.daddy@gmail.com", "post_code": "500003", "lead_status": "he will call", "street address": "Secunderabad", "what_is_your_average_monthly_electricity_bill?": "3500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "0f1a2b3c-4d5e-6f7a-8b9c-0d1e2f3a4b5c", "name": "Hari Engg", "email": "haraharaengnirangworks@gmail.com", "phone": "919600000001", "status": "new", "fields": { "full name": "Hari Engg", "phone": "919600000001", "email": "haraharaengnirangworks@gmail.com", "post_code": "500018", "lead_status": "not lifted", "street address": "Banashankari", "what_is_your_average_monthly_electricity_bill?": "8000", "what_type_of_property_do_you_want_to_install_solar_on?": "commercial" } },
  { "id": "1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d", "name": "Keshav Mamidi", "email": "kesh.mamidi@yahoo.com", "phone": "919753086478", "status": "new", "fields": { "full name": "Keshav Mamidi", "phone": "919753086478", "email": "kesh.mamidi@yahoo.com", "post_code": "500091", "lead_status": "he will call", "street address": "Filmnagar", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "2b3c4d5e-6f7a-8b9c-0d1e-2f3a4b5c6d7e", "name": "Kiran CNN", "email": "kiranjcnncm@gmail.com", "phone": "919666666666", "status": "new", "fields": { "full name": "Kiran CNN", "phone": "919666666666", "email": "kiranjcnncm@gmail.com", "post_code": "500034", "lead_status": "call", "street address": "Begumpet", "what_is_your_average_monthly_electricity_bill?": "4000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f", "name": "VR Pharma", "email": "vrpharma15@gmail.com", "phone": "919555555555", "status": "new", "fields": { "full name": "VR Pharma", "phone": "919555555555", "email": "vrpharma15@gmail.com", "post_code": "500048", "lead_status": "he will call", "street address": "Nandambakkam", "what_is_your_average_monthly_electricity_bill?": "9000", "what_type_of_property_do_you_want_to_install_solar_on?": "commercial" } },
  { "id": "4d5e6f7a-8b9c-0d1e-2f3a-4b5c6d7e8f9a", "name": "Krishnan", "email": "www.krishnan77@gmail.com", "phone": "919444444444", "status": "new", "fields": { "full name": "Krishnan", "phone": "919444444444", "email": "www.krishnan77@gmail.com", "post_code": "500075", "lead_status": "he will call", "street address": "Miyapur", "what_is_your_average_monthly_electricity_bill?": "3000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b", "name": "Nani", "email": "nani9985859199@gmail.com", "phone": "919333333333", "status": "new", "fields": { "full name": "Nani", "phone": "919333333333", "email": "nani9985859199@gmail.com", "post_code": "500016", "lead_status": "not lifted", "street address": "Madhapur", "what_is_your_average_monthly_electricity_bill?": "7000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "6f7a8b9c-0d1e-2f3a-4b5c-6d7e8f9a0b1c", "name": "Aveeavis", "email": "aveeavis1@gmail.com", "phone": "919222222222", "status": "new", "fields": { "full name": "Aveeavis", "phone": "919222222222", "email": "aveeavis1@gmail.com", "post_code": "500039", "lead_status": "he will call", "street address": "Maisammaguda", "what_is_your_average_monthly_electricity_bill?": "5000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d", "name": "Sai Vamsi", "email": "saivamsi8369@gmail.com", "phone": "919111111111", "status": "new", "fields": { "full name": "Sai Vamsi", "phone": "919111111111", "email": "saivamsi8369@gmail.com", "post_code": "500043", "lead_status": "he will call", "street address": "Habsiguda", "what_is_your_average_monthly_electricity_bill?": "6500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e", "name": "Naga Prasad", "email": "nagapradad.svnr@gmail.com", "phone": "919000000000", "status": "new", "fields": { "full name": "Naga Prasad", "phone": "919000000000", "email": "nagapradad.svnr@gmail.com", "post_code": "500008", "lead_status": "not lifted", "street address": "Nampally", "what_is_your_average_monthly_electricity_bill?": "4000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "9c0d1e2f-3a4b-5c6d-7e8f-9a0b1c2d3e4f", "name": "Raju Lodelly", "email": "rajulodelly@gmail.com", "phone": "918999999999", "status": "new", "fields": { "full name": "Raju Lodelly", "phone": "918999999999", "email": "rajulodelly@gmail.com", "post_code": "500025", "lead_status": "he will call", "street address": "Mylapore", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5a", "name": "KP Suites", "email": "info@kpsuites.in", "phone": "918888888888", "status": "new", "fields": { "full name": "KP Suites", "phone": "918888888888", "email": "info@kpsuites.in", "post_code": "500019", "lead_status": "quotation sent", "street address": "Banasthali", "what_is_your_average_monthly_electricity_bill?": "10000", "what_type_of_property_do_you_want_to_install_solar_on?": "commercial" } },
  { "id": "1e2f3a4b-5c6d-7e8f-9a0b-1c2d3e4f5a6b", "name": "Rajesh Kumar", "email": "kethavathrajeshkumar@gmail.com", "phone": "918777777777", "status": "new", "fields": { "full name": "Rajesh Kumar", "phone": "918777777777", "email": "kethavathrajeshkumar@gmail.com", "post_code": "500028", "lead_status": "he will call", "street address": "Ramnagar", "what_is_your_average_monthly_electricity_bill?": "4500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "2f3a4b5c-6d7e-8f9a-0b1c-2d3e4f5a6b7c", "name": "Naveen Rao", "email": "palthineninaveenrao@gmail.com", "phone": "918666666666", "status": "new", "fields": { "full name": "Naveen Rao", "phone": "918666666666", "email": "palthineninaveenrao@gmail.com", "post_code": "500020", "lead_status": "not lifted", "street address": "Mohan Nagar", "what_is_your_average_monthly_electricity_bill?": "3500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "3a4b5c6d-7e8f-9a0b-1c2d-3e4f5a6b7c8d", "name": "Arvind Ramillar", "email": "ramillarvind@gmail.com", "phone": "918555555555", "status": "new", "fields": { "full name": "Arvind Ramillar", "phone": "918555555555", "email": "ramillarvind@gmail.com", "post_code": "500010", "lead_status": "he will call", "street address": "Hyderabad City", "what_is_your_average_monthly_electricity_bill?": "6000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "4b5c6d7e-8f9a-0b1c-2d3e-4f5a6b7c8d9e", "name": "Aneela Dasari", "email": "aneeladasari@gmail.com", "phone": "918444444444", "status": "new", "fields": { "full name": "Aneela Dasari", "phone": "918444444444", "email": "aneeladasari@gmail.com", "post_code": "500041", "lead_status": "he will call", "street address": "Khairtabad", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "5c6d7e8f-9a0b-1c2d-3e4f-5a6b7c8d9e0f", "name": "Mallesh Yadav", "email": "malleshyadav611@gmail.com", "phone": "918333333333", "status": "new", "fields": { "full name": "Mallesh Yadav", "phone": "918333333333", "email": "malleshyadav611@gmail.com", "post_code": "500060", "lead_status": "he will call", "street address": "Domalguda", "what_is_your_average_monthly_electricity_bill?": "4500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "6d7e8f9a-0b1c-2d3e-4f5a-6b7c8d9e0f1a", "name": "Harish Patnaik", "email": "harishpatnaik22@gmail.com", "phone": "918222222222", "status": "new", "fields": { "full name": "Harish Patnaik", "phone": "918222222222", "email": "harishpatnaik22@gmail.com", "post_code": "500007", "lead_status": "not lifted", "street address": "Himayathnagar", "what_is_your_average_monthly_electricity_bill?": "3000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "7e8f9a0b-1c2d-3e4f-5a6b-7c8d9e0f1a2b", "name": "Kannappa", "email": "kannappa.skating@gmail.com", "phone": "918111111111", "status": "new", "fields": { "full name": "Kannappa", "phone": "918111111111", "email": "kannappa.skating@gmail.com", "post_code": "500031", "lead_status": "he will call", "street address": "Charminar", "what_is_your_average_monthly_electricity_bill?": "2500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "8f9a0b1c-2d3e-4f5a-6b7c-8d9e0f1a2b3c", "name": "Lara Photography", "email": "photographybylara5@gmail.com", "phone": "918000000000", "status": "new", "fields": { "full name": "Lara Photography", "phone": "918000000000", "email": "photographybylara5@gmail.com", "post_code": "500002", "lead_status": "call", "street address": "Abids", "what_is_your_average_monthly_electricity_bill?": "3500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d", "name": "Raghu Tutor", "email": "raghuthetutor@gmail.com", "phone": "919999999999", "status": "new", "fields": { "full name": "Raghu Tutor", "phone": "919999999999", "email": "raghuthetutor@gmail.com", "post_code": "500023", "lead_status": "not lifted", "street address": "Vidyanagar", "what_is_your_average_monthly_electricity_bill?": "4000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "0b1c2d3e-4f5a-6b7c-8d9e-0f1a2b3c4d5e", "name": "KV Rao", "email": "kvgraoamruth@gmail.com", "phone": "919888888888", "status": "new", "fields": { "full name": "KV Rao", "phone": "919888888888", "email": "kvgraoamruth@gmail.com", "post_code": "500011", "lead_status": "he will call", "street address": "Basheerbagh", "what_is_your_average_monthly_electricity_bill?": "5000", "what_type_of_property_do_you_want_to_install_solar_on?": "apartment_/_housing_society" } },
  { "id": "1c2d3e4f-5a6b-7c8d-9e0f-1a2b3c4d5e6f", "name": "Prakash Namala", "email": "namalaprakash7369@gmail.com", "phone": "919777777777", "status": "new", "fields": { "full name": "Prakash Namala", "phone": "919777777777", "email": "namalaprakash7369@gmail.com", "post_code": "500015", "lead_status": "he will call", "street address": "Tanks Bund", "what_is_your_average_monthly_electricity_bill?": "6500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "2d3e4f5a-6b7c-8d9e-0f1a-2b3c4d5e6f7a", "name": "Alekhya Rajesh", "email": "alekhyarajesh567@gmail.com", "phone": "919666666666", "status": "new", "fields": { "full name": "Alekhya Rajesh", "phone": "919666666666", "email": "alekhyarajesh567@gmail.com", "post_code": "500026", "lead_status": "not lifted", "street address": "Mylapore", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "3e4f5a6b-7c8d-9e0f-1a2b-3c4d5e6f7a8b", "name": "Suresh Maloth", "email": "malothsuresh803@mail.com", "phone": "919555555555", "status": "new", "fields": { "full name": "Suresh Maloth", "phone": "919555555555", "email": "malothsuresh803@mail.com", "post_code": "500040", "lead_status": "he will call", "street address": "Hyderabad", "what_is_your_average_monthly_electricity_bill?": "4500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "4f5a6b7c-8d9e-0f1a-2b3c-4d5e6f7a8b9c", "name": "Pinkuli Rout", "email": "pinkulirout09@gmail.com", "phone": "919444444444", "status": "new", "fields": { "full name": "Pinkuli Rout", "phone": "919444444444", "email": "pinkulirout09@gmail.com", "post_code": "500009", "lead_status": "not lifted", "street address": "Mohan Nagar", "what_is_your_average_monthly_electricity_bill?": "5000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "5a6b7c8d-9e0f-1a2b-3c4d-5e6f7a8b9c0d", "name": "Nirajan Purru", "email": "nirajanpurru@gmail.com", "phone": "919333333333", "status": "new", "fields": { "full name": "Nirajan Purru", "phone": "919333333333", "email": "nirajanpurru@gmail.com", "post_code": "500012", "lead_status": "he will call", "street address": "Shadnagar", "what_is_your_average_monthly_electricity_bill?": "6000", "what_type_of_property_do_you_want_to_install_solar_on?": "apartment_/_housing_society" } },
  { "id": "6b7c8d9e-0f1a-2b3c-4d5e-6f7a8b9c0d1e", "name": "Chintu Krishna", "email": "chintukrishna@gmail.com", "phone": "919222222222", "status": "new", "fields": { "full name": "Chintu Krishna", "phone": "919222222222", "email": "chintukrishna@gmail.com", "post_code": "500022", "lead_status": "call", "street address": "Ramakrishnapur", "what_is_your_average_monthly_electricity_bill?": "4500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "7c8d9e0f-1a2b-3c4d-5e6f-7a8b9c0d1e2f", "name": "Lokesh Parnam", "email": "parnamlokesh333@gmail.com", "phone": "919111111111", "status": "new", "fields": { "full name": "Lokesh Parnam", "phone": "919111111111", "email": "parnamlokesh333@gmail.com", "post_code": "500050", "lead_status": "he will call", "street address": "Chandrayangutta", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a", "name": "Ganesh Gani", "email": "ganiganesh784@gmail.com", "phone": "919000000001", "status": "new", "fields": { "full name": "Ganesh Gani", "phone": "919000000001", "email": "ganiganesh784@gmail.com", "post_code": "500032", "lead_status": "not lifted", "street address": "Char Minar", "what_is_your_average_monthly_electricity_bill?": "3500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "9e0f1a2b-3c4d-5e6f-7a8b-9c0d1e2f3a4b", "name": "Rana Dheer Reddy", "email": "ranadheerreddy.kaluvala@gmail.com", "phone": "919777777778", "status": "new", "fields": { "full name": "Rana Dheer Reddy", "phone": "919777777778", "email": "ranadheerreddy.kaluvala@gmail.com", "post_code": "500062", "lead_status": "he will call", "street address": "Golconda", "what_is_your_average_monthly_electricity_bill?": "6000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "0f1a2b3c-4d5e-6f7a-8b9c-0d1e2f3a4b5c", "name": "Diwakar Lawyer", "email": "diwakarlawyer72@gmail.com", "phone": "919666666665", "status": "new", "fields": { "full name": "Diwakar Lawyer", "phone": "919666666665", "email": "diwakarlawyer72@gmail.com", "post_code": "500051", "lead_status": "he will call", "street address": "Old City", "what_is_your_average_monthly_electricity_bill?": "4500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d", "name": "Vamshi Mohan", "email": "vamshimohan12@gmail.com", "phone": "919555555554", "status": "new", "fields": { "full name": "Vamshi Mohan", "phone": "919555555554", "email": "vamshimohan12@gmail.com", "post_code": "500027", "lead_status": "not lifted", "street address": "Secunderabad City", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "2b3c4d5e-6f7a-8b9c-0d1e-2f3a4b5c6d7e", "name": "Harsha Devaraya", "email": "harshadevaraya2612@gmail.com", "phone": "919444444443", "status": "new", "fields": { "full name": "Harsha Devaraya", "phone": "919444444443", "email": "harshadevaraya2612@gmail.com", "post_code": "500029", "lead_status": "he will call", "street address": "Mahabub Nagar", "what_is_your_average_monthly_electricity_bill?": "4000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "3c4d5e6f-7a8b-9c0d-1e2f-3a4b5c6d7e8f", "name": "Dilip Naik", "email": "banoth.dilipnaik@gmail.com", "phone": "919333333332", "status": "new", "fields": { "full name": "Dilip Naik", "phone": "919333333332", "email": "banoth.dilipnaik@gmail.com", "post_code": "500037", "lead_status": "he will call", "street address": "Saroojini Devi Road", "what_is_your_average_monthly_electricity_bill?": "6500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "4d5e6f7a-8b9c-0d1e-2f3a-4b5c6d7e8f9a", "name": "Kishan Yadav", "email": "kishanyadav9000@gmail.com", "phone": "919222222221", "status": "new", "fields": { "full name": "Kishan Yadav", "phone": "919222222221", "email": "kishanyadav9000@gmail.com", "post_code": "500056", "lead_status": "not lifted", "street address": "Rangareddy", "what_is_your_average_monthly_electricity_bill?": "5000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b", "name": "Sugandha Rama Rao", "email": "sugandhamramarao@gmail.com", "phone": "919111111110", "status": "new", "fields": { "full name": "Sugandha Rama Rao", "phone": "919111111110", "email": "sugandhamramarao@gmail.com", "post_code": "500014", "lead_status": "he will call", "street address": "Kala Niketan", "what_is_your_average_monthly_electricity_bill?": "4500", "what_type_of_property_do_you_want_to_install_solar_on?": "apartment_/_housing_society" } },
  { "id": "6f7a8b9c-0d1e-2f3a-4b5c-6d7e8f9a0b1c", "name": "Padmavathi", "email": "chpadmavathi36@gmail.com", "phone": "919000000002", "status": "new", "fields": { "full name": "Padmavathi", "phone": "919000000002", "email": "chpadmavathi36@gmail.com", "post_code": "500017", "lead_status": "not lifted", "street address": "Tarnaka", "what_is_your_average_monthly_electricity_bill?": "3500", "what_type_of_property_do_you_want_to_install_solar_on?": "apartment_/_housing_society" } },
  { "id": "7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d", "name": "Kanapur Amara", "email": "kanapuram111@gmail.com", "phone": "919888888887", "status": "new", "fields": { "full name": "Kanapur Amara", "phone": "919888888887", "email": "kanapuram111@gmail.com", "post_code": "500065", "lead_status": "he will call", "street address": "Kukatpalli", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e", "name": "Nari Bangaru", "email": "naribangaru07@gmail.com", "phone": "919777777776", "status": "new", "fields": { "full name": "Nari Bangaru", "phone": "919777777776", "email": "naribangaru07@gmail.com", "post_code": "500035", "lead_status": "he will call", "street address": "Nampally", "what_is_your_average_monthly_electricity_bill?": "5000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "9c0d1e2f-3a4b-5c6d-7e8f-9a0b1c2d3e4f", "name": "Srikanth Goud", "email": "srikanthgoudssg9@gmail.com", "phone": "919666666664", "status": "new", "fields": { "full name": "Srikanth Goud", "phone": "919666666664", "email": "srikanthgoudssg9@gmail.com", "post_code": "500047", "lead_status": "call", "street address": "Serilingampally", "what_is_your_average_monthly_electricity_bill?": "6500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5a", "name": "Santosh Yadav", "email": "santoshyadav9989@yahoo.com", "phone": "919555555553", "status": "new", "fields": { "full name": "Santosh Yadav", "phone": "919555555553", "email": "santoshyadav9989@yahoo.com", "post_code": "500030", "lead_status": "he will call", "street address": "Afzalgunj", "what_is_your_average_monthly_electricity_bill?": "4500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "1e2f3a4b-5c6d-7e8f-9a0b-1c2d3e4f5a6b", "name": "Geethika", "email": "geethika186@gmail.com", "phone": "919444444442", "status": "new", "fields": { "full name": "Geethika", "phone": "919444444442", "email": "geethika186@gmail.com", "post_code": "500066", "lead_status": "not lifted", "street address": "Jntu", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "2f3a4b5c-6d7e-8f9a-0b1c-2d3e4f5a6b7c", "name": "Venkat B", "email": "bvenkat6434@gmail.com", "phone": "919333333331", "status": "new", "fields": { "full name": "Venkat B", "phone": "919333333331", "email": "bvenkat6434@gmail.com", "post_code": "500024", "lead_status": "he will call", "street address": "Karimnagar", "what_is_your_average_monthly_electricity_bill?": "5000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "3a4b5c6d-7e8f-9a0b-1c2d-3e4f5a6b7c8d", "name": "Ajay Laddu", "email": "ajayladdu78@gmail.com", "phone": "919222222220", "status": "new", "fields": { "full name": "Ajay Laddu", "phone": "919222222220", "email": "ajayladdu78@gmail.com", "post_code": "500045", "lead_status": "he will call", "street address": "Hyderabad", "what_is_your_average_monthly_electricity_bill?": "4000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "4b5c6d7e-8f9a-0b1c-2d3e-4f5a6b7c8d9e", "name": "Suresh Lav", "email": "suresh_lav2005@yahoo.com", "phone": "919111111109", "status": "new", "fields": { "full name": "Suresh Lav", "phone": "919111111109", "email": "suresh_lav2005@yahoo.com", "post_code": "500057", "lead_status": "he will call", "street address": "Tandur", "what_is_your_average_monthly_electricity_bill?": "6000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "5c6d7e8f-9a0b-1c2d-3e4f-5a6b7c8d9e0f", "name": "MR Craobdl", "email": "mrcraobdl47086@gmail.com", "phone": "919000000003", "status": "new", "fields": { "full name": "MR Craobdl", "phone": "919000000003", "email": "mrcraobdl47086@gmail.com", "post_code": "500074", "lead_status": "not lifted", "street address": "Bowenpally", "what_is_your_average_monthly_electricity_bill?": "5500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "6d7e8f9a-0b1c-2d3e-4f5a-6b7c8d9e0f1a", "name": "Sairam Chilukamari", "email": "sairam.chilukamari786@gmail.com", "phone": "919888888886", "status": "new", "fields": { "full name": "Sairam Chilukamari", "phone": "919888888886", "email": "sairam.chilukamari786@gmail.com", "post_code": "500061", "lead_status": "he will call", "street address": "Dilsukhnagar", "what_is_your_average_monthly_electricity_bill?": "6500", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } },
  { "id": "7e8f9a0b-1c2d-3e4f-5a6b-7c8d9e0f1a2b", "name": "Srikanth Goud S", "email": "srikanthgoudssg9@gmail.com", "phone": "919777777775", "status": "new", "fields": { "full name": "Srikanth Goud S", "phone": "919777777775", "email": "srikanthgoudssg9@gmail.com", "post_code": "500053", "lead_status": "he will call", "street address": "Vikarabad", "what_is_your_average_monthly_electricity_bill?": "5000", "what_type_of_property_do_you_want_to_install_solar_on?": "individual_house" } }
];

async function insertLeads() {
  console.log(`Inserting ${cleanedLeads.length} cleaned leads...`);
  const url = `${SUPABASE_URL.replace(/\/+$/, '')}/rest/v1/leads`;
  
  for (let i = 0; i < cleanedLeads.length; i += 20) {
    const chunk = cleanedLeads.slice(i, i + 20);
    const body = chunk.map(l => ({
      id: l.id,
      fields: l.fields || {},
      name: l.name || null,
      email: l.email || null,
      phone: l.phone || null,
      company: l.company || null,
      source: l.source || null,
      status: l.status || 'new',
      owner_id: l.ownerId || null,
      notes: l.notes || null,
      created_at: new Date().toISOString(),
      updated_at: new Date().toISOString()
    }));

    try {
      const res = await fetch(url, {
        method: 'POST',
        headers: {
          apikey: SUPABASE_KEY,
          Authorization: `Bearer ${SUPABASE_KEY}`,
          'Content-Type': 'application/json',
          Prefer: 'return=representation'
        },
        body: JSON.stringify(body)
      });

      if (!res.ok) {
        const text = await res.text();
        throw new Error(`Supabase ${res.status}: ${text}`);
      }

      console.log(`✓ Inserted ${chunk.length} leads (${i + chunk.length}/${cleanedLeads.length})`);
    } catch (e) {
      console.error(`Error inserting chunk at offset ${i}:`, e.message);
      throw e;
    }
  }

  console.log(`\n✅ Successfully inserted ${cleanedLeads.length} cleaned leads to Supabase`);
}

insertLeads().catch(() => process.exit(1));
